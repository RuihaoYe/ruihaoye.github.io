import{C as e,c as t,P as o,o as n,a as s,b as r,t as l,S as i,w as a,v as c,F as h,r as d,d as u,s as p,e as b,f as m,g as f,h as g,i as k,j as v,k as x,l as N,V as y}from"./vendor.0e51a1fe.js";const w=t({state:()=>({blogContent:{},notebookTree:[],notebookMap:{},noteMap:{},currentNotebook:null,currentNote:null,searchVisible:!1}),mutations:{setBlogContent(e,t){e.blogContent=t},initNotebook(e){let t=[],o={},n=e.blogContent.categories;if(n){for(let e of n){let n=e.slug;o[n]=e,e.name===n&&t.push(e),e.children=[],e.notes=[]}for(let e of n){let t=e.slug;if(e.name===t){e.level=1;continue}let n=o[t.substr(0,t.lastIndexOf("/"))];n.children.push(e),e.level=n.level+1}e.notebookTree=t,e.notebookMap=o}},initNote(e){for(let t of e.blogContent.posts){let o=0;for(let n of t.categories){let s=e.notebookMap[n.slug];s.notes.push(t),o<s.level&&(o=s.level,t.notebook=s)}e.noteMap[t.permalink]=t,t.content=void 0}},openNotebook(e,t){e.currentNotebook&&(e.currentNotebook.isOpen=!1),e.currentNotebook=e.notebookMap[t],e.currentNotebook.isOpen=!0},openNote(e,t){e.currentNote&&(e.currentNote.isOpen=!1),e.currentNote=e.noteMap[t],e.currentNote.isOpen=!0},setNoteContent(e,t){e.noteMap[t.permalink].toc=t.toc,e.noteMap[t.permalink].content=t.content},toggleSearch(e){e.searchVisible=!e.searchVisible},scrollToTop(){},toggleReadMode(){}},actions:{init({commit:e},t){e("setBlogContent",t),e("initNotebook"),e("initNote")},openNotebook({commit:e},t){e("openNotebook",t)},async openNote({commit:e,dispatch:t,state:o},n){let s=o.noteMap[n];await t("getNoteContent",s),e("openNote",n),e("openNotebook",o.currentNote.notebook.slug)},async getNoteContent({commit:t},o){if(o.content)return;let n=null,s=null,r=null;try{n=await e.get(`/${o.path}index.html`)}catch(i){return void alert("获取笔记内容失败")}let l=n.data.indexOf("<article>");-1===l?(alert("获取笔记目录失败"),s="",r=n.data):(s=n.data.substr(0,l),r=n.data.substr(l)),t("setNoteContent",{permalink:o.permalink,toc:s,content:r})}}});const C={computed:{note(){return this.$store.state.currentNote}},created(){this.$store.subscribe(this.handleScrollToTop)},updated(){o.highlightAll()},methods:{handleScrollToTop(e){"scrollToTop"===e.type&&this.scrollToTop()},scrollToTop(){this.note&&this.$refs["post-title"].scrollIntoView({behavior:"smooth"})}}},$={key:0},T={key:1,class:"\r\n      flex-1\r\n      overflow-y-auto\r\n      overscroll-y-none\r\n      h-screen\r\n      flex\r\n      justify-center\r\n    "},M={class:"xl:w-200 2xl:w-250"},I={ref:"post-title",class:"\r\n          m-2\r\n          p-2\r\n          border-b-2 border-gray-300\r\n          flex\r\n          justify-between\r\n          items-end\r\n        "},O={class:"font-serif text-3xl"},S={class:"italic font-serif text-gray-400 h-auto"},j={ref:"post-content",class:"mx-5 pb-20"};C.render=function(e,t,o,i,a,c){return c.note?(n(),s("div",T,[r("div",M,[r("div",I,[r("div",O,l(c.note.title),1),r("div",S,l("更新日期："+c.note.updated),1)],512),r("div",j,[r("div",{innerHTML:c.note.content},null,8,["innerHTML"])],512)])])):(n(),s("div",$))};const B={props:{note:Object},methods:{handleClick(){this.$store.dispatch("openNote",this.note.permalink)}}};B.render=function(e,t,o,i,a,c){return n(),s("div",{class:["flex","justify-between","hover:bg-yellow-200","px-2","py-1",o.note.isOpen?"bg-green-200":""],onClick:t[1]||(t[1]=(...e)=>c.handleClick&&c.handleClick(...e))},[r("span",null,l(o.note.title),1),r("span",null,l(o.note.date),1)],2)};const R={components:{noteBarItem:B},data:()=>({visible:!0}),computed:{noteNumber(){return this.$store.state.currentNotebook?this.$store.state.currentNotebook.notes.length:0},notes(){return this.$store.state.currentNotebook?this.$store.state.currentNotebook.notes:[]}},created(){this.$store.subscribe((e=>{"toggleReadMode"===e.type&&(this.visible=!this.visible)}))},mounted(){new i(this.$refs["note-list"])}},V={class:"\r\n      flex flex-col\r\n      w-48\r\n      xl:w-64\r\n      h-screen\r\n      border-r-2 border-gray-300\r\n      bg-green-50 bg-opacity-20\r\n    "},L={class:"m-2 p-2 rounded-md text-center shadow-xl"},H={ref:"note-list",class:"flex-auto flex flex-col overflow-y-auto overscroll-y-none"};R.render=function(e,t,o,i,p,b){const m=u("note-bar-item");return a((n(),s("div",V,[r("div",L,l(b.noteNumber)+"条笔记 ",1),r("div",H,[(n(!0),s(h,null,d(b.notes,(e=>(n(),s(m,{key:e.permalink,note:e},null,8,["note"])))),128))],512)],512)),[[c,p.visible]])};const D={props:["notebook"],data:()=>({}),computed:{twClass(){let e="",t=this.notebook.level;1===t?e="pl-3":2===t?e="pl-6":3===t&&(e="pl-9");let o="";return this.notebook.isOpen&&(o="bg-gray-600"),`${e} ${o} hover:bg-gray-500`}},methods:{handleClick(){this.$store.dispatch("openNotebook",this.notebook.slug)}}},A={class:"text-white mt-1"};D.render=function(e,t,o,i,a,c){const p=u("notebook-bar-item",!0);return n(),s("div",A,[r("div",{class:c.twClass,onClick:t[1]||(t[1]=(...e)=>c.handleClick&&c.handleClick(...e))},[r("a",null,l(o.notebook.name),1)],2),(n(!0),s(h,null,d(o.notebook.children,(e=>(n(),s(p,{key:e.permalink,notebook:e},null,8,["notebook"])))),128))])};const F={props:{theme:{type:String,defalut:"light"}},data(){return{searchIcon:"light"===this.theme?p:b,fullscreenIcon:"light"===this.theme?m:f,topIcon:"light"===this.theme?g:k}},methods:{handleOpenSearch(){this.$store.commit("toggleSearch")},handleReadMode(){this.$store.state.currentNote&&this.$store.commit("toggleReadMode")},handleScrollToTop(){this.$store.state.currentNote&&this.$store.commit("scrollToTop")}}},G={class:"w-36 xl:w-56 h-20 flex justify-around items-center"};F.render=function(e,t,o,l,i,a){return n(),s("div",G,[r("img",{class:"cursor-pointer transform hover:scale-110",src:i.searchIcon,onClick:t[1]||(t[1]=(...e)=>a.handleOpenSearch&&a.handleOpenSearch(...e))},null,8,["src"]),r("img",{class:"cursor-pointer transform hover:scale-110",src:i.fullscreenIcon,onClick:t[2]||(t[2]=(...e)=>a.handleReadMode&&a.handleReadMode(...e))},null,8,["src"]),r("img",{class:"cursor-pointer transform hover:scale-110",src:i.topIcon,onClick:t[3]||(t[3]=(...e)=>a.handleScrollToTop&&a.handleScrollToTop(...e))},null,8,["src"])])};const P={components:{notebookBarItem:D,OperateBtn:F},data:()=>({visible:!0}),computed:{notebookTree(){return this.$store.state.notebookTree}},created(){this.$store.subscribe((e=>{"toggleReadMode"===e.type&&(this.visible=!this.visible)}))},mounted(){new i(this.$refs["notebook-list"])}},U={class:"flex flex-col w-36 xl:w-56 h-screen bg-gray-800"},q={ref:"notebook-list",class:"flex flex-col overflow-y-auto overscroll-y-none"};P.render=function(e,t,o,l,i,p){const b=u("operate-btn"),m=u("notebook-bar-item");return a((n(),s("div",U,[r(b,{theme:"light"}),r("div",q,[(n(!0),s(h,null,d(p.notebookTree,(e=>(n(),s(m,{key:e.slug,notebook:e},null,8,["notebook"])))),128))],512)],512)),[[c,i.visible]])};const z={components:{operateBtn:F},data:()=>({visible:!1}),computed:{note(){let e=this.$store.state.currentNote;return e||(e={toc:""}),e}},created(){this.$store.subscribe((e=>{"toggleReadMode"===e.type&&(this.visible=!this.visible)}))}},E={class:"w-56 h-screen flex flex-col justify-center mx-32"};z.render=function(e,t,o,l,i,h){const d=u("operate-btn");return a((n(),s("div",E,[r(d,{theme:"dark"}),r("div",{innerHTML:h.note.toc},null,8,["innerHTML"])],512)),[[c,i.visible]])};const J={data:()=>({searchContent:"",searchIcon:p,postIdx:0}),computed:{visible(){return this.$store.state.searchVisible},notes(){if(!this.searchContent||""===this.searchContent)return[];let e=this.searchContent.toLowerCase();const t=this.$store.state.noteMap,o=[];for(const n in t){const s=t[n];s.title.toLowerCase().includes(e)&&o.push({title:s.title,date:s.date,permalink:s.permalink})}return this.postIdx>=0&&this.postIdx<o.length&&(o[this.postIdx].selected=!0),o}},created(){v.filter=function(e){return!0},v("alt+s",(e=>{e.preventDefault(),this.visible||this.$store.commit("toggleSearch")})),v("esc",(e=>{e.preventDefault(),this.visible&&this.$store.commit("toggleSearch")}))},updated(){this.visible&&this.$refs["search-input"].focus()},watch:{visible(e,t){e&&!t?(v("down",(()=>{let e=this.postIdx+1;e>=this.notes.length&&(e=0),this.postIdx=e})),v("up",(()=>{let e=this.postIdx-1;e<0&&(e=this.notes.length>0?this.notes.length-1:0),this.postIdx=e})),v("enter",(()=>{this.handleOpenNote(this.notes[this.postIdx].permalink)}))):!e&&t&&(v.unbind("down"),v.unbind("up"),v.unbind("enter"))}},methods:{handleOpenNote(e){this.$store.dispatch("openNote",e),this.searchContent="",this.$store.commit("toggleSearch")}}},K={class:"fixed top-1/3 inset-x-1/3 p-4 rounded-2xl bg-gray-200 shadow-2xl"},Q={ref:"search-bar",class:"flex border-b-2 border-gray-500"},W={class:"flex flex-col overflow-y-auto mt-3"};J.render=function(e,t,o,i,u,p){return a((n(),s("div",K,[r("div",Q,[r("img",{class:"w-9 h-9 my-auto",src:u.searchIcon},null,8,["src"]),a(r("input",{ref:"search-input",type:"search",placeholder:"输入笔记标题...",class:"\r\n          h-16\r\n          w-full\r\n          text-base\r\n          appearance-none\r\n          outline-none\r\n          bg-transparent\r\n        ","onUpdate:modelValue":t[1]||(t[1]=e=>u.searchContent=e)},null,512),[[x,u.searchContent]])],512),r("div",W,[(n(!0),s(h,null,d(p.notes,(e=>(n(),s("div",{key:e.permalink,class:["flex justify-between px-2 py-1 w-full hover:bg-yellow-200",[e.selected?"bg-green-200":""]],onClick:t=>p.handleOpenNote(e.permalink)},[r("span",null,l(e.title),1),r("span",null,l(e.date),1)],10,["onClick"])))),128))])],512)),[[c,p.visible]])};const X={components:{NotebookBar:P,NoteBar:R,MdNote:C,NoteContents:z,GlobalSearch:J},created(){this.$http.get("/content.json").then((e=>{this.$store.dispatch("init",e.data)}))}},Y={class:"flex"};X.render=function(e,t,o,l,i,a){const c=u("notebook-bar"),h=u("note-bar"),d=u("note-contents"),p=u("md-note"),b=u("global-search");return n(),s("div",Y,[r(c),r(h),r(d),r(p),r(b)])};const Z=N(X);Z.use(y,e),Z.use(w),Z.mount("#app");
